<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PSEYPL9P20"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-PSEYPL9P20');
  </script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chapter - LearnBite</title>
  <style>
    /* Import Google Fonts */
    @import url('https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300;0,400;0,500;0,700;1,400&display=swap');

    /* Base CSS Variables */
    :root {
      --primary-color: #FF6B6B;
      --secondary-color: #1CB0F6;
      --accent-color: #58CC02;
      --text-color: #2D2D2D;
      --white: #FFFFFF;
      --bg-color: #F8F9FA;
      --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      --border-radius: 16px;
    }
    /* Dark mode overrides */
    [data-theme="dark"] {
      --primary-color: #58cc02;
      --secondary-color: #1CB0F6;
      --accent-color: #ff6b6b;
      --text-color: #ffffff;
      --white: #111111;
      --bg-color: #000000;
      --card-shadow: 0 4px 12px rgba(192, 192, 192, 0.377);
    }
    /* Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Rubik', sans-serif;
    }
    .hidden { display: none; }
    body {
      background: linear-gradient(135deg, #FFDEE9, #B5FFFC);
      color: var(--text-color);
      line-height: 1.5;
      min-height: 100vh;
      animation: bgPulse 6s ease-in-out infinite;
    }
    /* Disable gradient animation and use solid dark background in dark mode */
    [data-theme="dark"] body {
      background: var(--bg-color);
      animation: none;
    }
    @keyframes bgPulse {
      0%, 100% { filter: brightness(1); }
      50% { filter: brightness(1.05); }
    }
    /* Header */
    .header {
      position: sticky;
      top: 0;
      width: 100%;
      background: var(--white);
      box-shadow: var(--card-shadow);
      z-index: 1000;
      border-bottom: 3px solid var(--secondary-color);
      animation: headerBounce 0.6s ease-out;
    }
    @keyframes headerBounce {
      0% { transform: translateY(-10px); opacity: 0; }
      100% { transform: translateY(0); opacity: 1; }
    }
    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
    }
    .logo {
      height: 50px;
      transition: transform 0.2s ease, filter 0.2s ease;
    }
    .logo:hover {
      transform: scale(1.1);
      filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.2));
    }
    .menu-toggle {
      background: none;
      border: none;
      cursor: pointer;
      display: none;
      flex-direction: column;
      gap: 4px;
    }
    .menu-toggle .hamburger {
      width: 25px;
      height: 3px;
      background: var(--text-color);
      transition: all 0.3s ease;
    }
    .menu-toggle:hover .hamburger {
      transform: scaleX(1.1);
    }
    .main_nav {
      background: var(--white);
    }
    .main_nav_list {
      display: flex;
      gap: 1.5rem;
      list-style: none;
      padding: 0 2rem 1rem;
      justify-content: center;
    }
    .main_nav_link {
      text-decoration: none;
      color: var(--text-color);
      font-weight: 500;
      padding: 0.75rem 1.25rem;
      border-radius: 50px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .main_nav_link:hover {
      background: rgba(28, 176, 246, 0.15);
      transform: translateY(-2px);
    }
    .larry_btn {
      background: var(--secondary-color);
      color: var(--white);
      box-shadow: 0 3px 0 #0F8ECB;
      text-decoration: none;
      padding: 0.75rem 1.25rem;
      border-radius: 50px;
      transition: transform 0.3s ease;
    }
    .larry_btn:hover {
      transform: scale(1.03);
    }
    /* Main Container */
    .container {
      max-width: 800px;
      margin: 2rem auto;
      padding: 2rem;
      background: var(--white);
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      position: relative;
      overflow: hidden;
      animation: popIn 0.8s ease-out;
    }
    @keyframes popIn {
      0% { opacity: 0; transform: scale(0.95); }
      100% { opacity: 1; transform: scale(1); }
    }
    .container::before {
      content: "";
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background-image: radial-gradient(circle, rgba(255,255,255,0.15) 1px, transparent 1px);
      background-size: 20px 20px;
      opacity: 0.5;
      pointer-events: none;
      animation: rotateBackground 20s linear infinite;
    }
    @keyframes rotateBackground {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    /* Breadcrumb */
    .breadcrumb {
      font-size: 0.9rem;
      margin-bottom: 1rem;
      text-align: center;
    }
    .breadcrumb a {
      text-decoration: none;
      color: var(--secondary-color);
    }
    .breadcrumb span {
      margin: 0 0.5rem;
      color: #888;
    }
    /* Chapter Header & Tags */
    .chapter-title {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
      text-align: center;
      animation: pop 0.6s ease-out forwards;
    }
    @keyframes pop {
      0% { transform: scale(0.8); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }
    .tags {
      margin-bottom: 1rem;
      text-align: center;
    }
    .tag {
      display: inline-block;
      background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
      color: var(--white);
      padding: 0.4rem 0.8rem;
      border-radius: 20px;
      margin-right: 0.5rem;
      font-size: 0.9rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }
    .tag:hover {
      transform: scale(1.05);
    }
    /* Chapter Content */
    .chapter-content {
      margin-bottom: 2rem;
      line-height: 1.8;
      font-size: 1.1rem;
      text-align: justify;
    }
    /* Enhanced Quiz Section Styling */
    .quiz-section {
      margin-top: 2rem;
      padding: 2rem;
      background: #fff9e6;
      border: 2px solid var(--secondary-color);
      border-radius: 16px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .quiz-section:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }
    .quiz-section h2 {
      margin-bottom: 1.5rem;
      text-align: center;
      font-size: 1.8rem;
      color: var(--primary-color);
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }
    /* Quiz Container and Questions */
    #quizContainer {
      margin-bottom: 1rem;
    }
    .quiz-question {
      background: var(--white);
      border: 1px solid #ddd;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      transition: transform 0.2s ease;
    }
    .quiz-question:hover {
      transform: translateY(-2px);
    }
    .quiz-result {
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 8px;
      font-weight: bold;
      text-align: center;
      background: #e0ffe0;
      border: 1px solid var(--primary-color);
    }
    /* Related Chapters */
    .related-chapters {
      margin-top: 2rem;
    }
    .related-chapter-card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 0.8rem;
      margin-bottom: 1rem;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .related-chapter-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .related-chapter-card a {
      text-decoration: none;
      color: var(--secondary-color);
    }
    /* Footer */
    .footer {
      background: var(--secondary-color);
      color: var(--white);
      text-align: center;
      padding: 1rem;
      margin-top: 2rem;
    }
    /* Action Button */
    .action-btn {
      background: var(--primary-color);
      color: var(--white);
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 50px;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease;
      margin-top: 1rem;
      display: inline-block;
    }
    .action-btn:hover {
      background: #e05555;
      transform: scale(1.05);
    }
    /* Responsive Styles */
    @media (max-width: 768px) {
      .header-container { padding: 0.75rem 1rem; }
      .menu-toggle { display: flex; }
      .main_nav_list { flex-direction: column; gap: 1rem; padding: 0 1rem 1rem; }
      .main_nav { display: none; }
      .main_nav.active { display: block; }
      .chapter-title { font-size: 2rem; }
      .chapter-content { font-size: 1rem; }
      .quiz-section { padding: 1.5rem; }
      .action-btn { padding: 0.65rem 1.25rem; font-size: 0.9rem; }
    }
    @media (max-width: 480px) {
      .header-container { flex-direction: column; }
      .breadcrumb { font-size: 0.8rem; }
      .chapter-title { font-size: 1.8rem; }
      .tag { font-size: 0.8rem; padding: 0.3rem 0.6rem; }
      .chapter-content { font-size: 0.95rem; }
    }
    /* Dark mode overrides for the Quiz section and its components */
    [data-theme="dark"] .quiz-section {
      background: #2c2c2c;
      border: 2px solid var(--secondary-color);
      box-shadow: 0 4px 8px rgba(0,0,0,0.5);
    }
    [data-theme="dark"] .quiz-section h2 {
      color: var(--primary-color);
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }
    [data-theme="dark"] .quiz-question {
      background: #444;
      border: 1px solid #555;
      color: var(--text-color);
    }
    [data-theme="dark"] .quiz-result {
      background: #555;
      border: 1px solid var(--primary-color);
      color: var(--text-color);
    }

    /* Table Styling */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1.5rem;
      font-size: 1rem;
      color: var(--text-color);
    }
    table th, table td {
      padding: 0.75rem;
      border: 1px solid #ddd;
      text-align: left;
    }
    table thead {
      background: var(--secondary-color);
      color: var(--white);
    }
    table tbody tr:nth-child(even) {
      background: #f8f9fa;
    }
    
    table tbody tr:hover {
      background: #f1f1f1;
    }
    [data-theme="dark"] table tbody tr:nth-child(even) {
      background: #19191a;
    }
    [data-theme="dark"] table tbody tr:hover {
      background: #2e2e2e;
    }
    /* Ensure header is flexible */
.header-container {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem 1rem;
}

/* Keep logo on the left */
.logo {
  height: 50px;
  transition: transform 0.2s ease, filter 0.2s ease;
}

.logo:hover {
  transform: scale(1.05);
}

/* Align theme and login buttons properly */
.header-right {
  display: flex;
  align-items: center;
  gap: 1rem;
}

/* Make the login button look professional */
.login_btn {
  background: var(--secondary-color);
  color: var(--white) !important;
  text-decoration: none;
  padding: 0.6rem 1.2rem;
  border-radius: 50px;
  cursor: pointer;
  font-weight: bold;
  border: none;
  transition: all 0.2s ease;
}

.login_btn:hover {
  background: #0f8ecb;
}

/* Mobile Navigation Styles */
@media (max-width: 768px) {
  .header-container {
    flex-direction: row;
  }

  .logo {
    height: 40px;
    margin-right: auto;
  }

  .header-right {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .menu-toggle {
    display: flex;
    flex-direction: column;
    gap: 4px;
    background: none;
    border: none;
    cursor: pointer;
  }

  .menu-toggle .hamburger {
    width: 25px;
    height: 3px;
    background: var(--text-color);
    transition: all 0.3s ease;
  }

  /* Animate hamburger into close icon */
  .menu-toggle.active .hamburger:nth-child(1) {
    transform: translateY(7px) rotate(45deg);
  }

  .menu-toggle.active .hamburger:nth-child(2) {
    opacity: 0;
  }

  .menu-toggle.active .hamburger:nth-child(3) {
    transform: translateY(-7px) rotate(-45deg);
  }

  /* Mobile Nav Overlay */
  .main_nav {
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    background: var(--white);
    box-shadow: var(--card-shadow);
    transition: transform 0.3s ease, opacity 0.3s ease;
    transform: translateY(-20px);
    opacity: 0;
    pointer-events: none;
  }

  .main_nav.active {
    transform: translateY(0);
    opacity: 1;
    pointer-events: auto;
  }

  /* Align navigation to the left */
  .main_nav_list {
    flex-direction: column;
    gap: 1rem;
    padding: 1rem;
    align-items: flex-start; /* Left-align items */
  }

  .main_nav_link {
    padding: 1rem;
    font-size: 1.2rem;
    border-radius: 8px;
    transition: background 0.2s ease, transform 0.2s ease;
  }

  .main_nav_link:hover {
    background: rgba(88, 204, 2, 0.15);
    transform: translateY(-2px);
  }

  /* Make login button fit better in mobile */
  .login_btn {
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
  }
}
    /* Theme Toggle */
    .theme-toggle {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.5rem;
      padding: 0.5rem;
      margin-left: auto;
      transition: transform 0.3s ease;
    }

    .theme-toggle:hover {
      transform: rotate(20deg);
    }
  </style>
</head>
<body>
  <!-- Header -->
<header class="header">
  <div class="header-container">
    <p><a href="https://sinanneedtocode.github.io/LearnBite">
    <img src="imgs/duolingo-landscape-lockup.png" alt="LearnBite Logo" class="logo">
  </a>
    </p>
    <div class="header-right">
      <button id="themeToggle" class="theme-toggle">🌓</button>
      <button class="login_btn" onclick="openLoginModal()">Login</button>
      <button class="menu-toggle" onclick="toggleMenu()">
        <span class="hamburger"></span>
        <span class="hamburger"></span>
        <span class="hamburger"></span>
      </button> 
    </div>
  </div>
  <nav class="main_nav" id="mainNav">
    <ul class="main_nav_list">
      <li><a href="index.html" class="main_nav_link">Home</a></li>
      <li><a href="larry.html" class="main_nav_link larry_btn">Ask Larry</a></li>
      <li><a href="timer.html" class="main_nav_link larry_btn">Study Companion</a></li>
    </ul>
  </nav>
</header>

  <!-- Main Content -->
  <main class="container">
    <!-- Breadcrumb Navigation -->
    <nav class="breadcrumb">
      <a href="index.html">Home</a> <span>/</span>
      <span id="subjectBreadcrumb">Error</span> <span>/</span>
      <span id="chapterBreadcrumb">Error</span>
    </nav>
    <!-- Chapter Header -->
    <h1 id="chapterTitle" class="chapter-title">Error</h1>
    <div class="tags">
      <span id="subjectTag" class="tag">Error</span>
      <span id="difficultyTag" class="tag">Error</span>
    </div>
    <!-- Chapter Content -->
    <div id="chapterContent" class="chapter-content">
      <p>THE CONTENT'S OF THE CHAPTER HAS FAILED TO LOAD</p>
    </div>
    <!-- Quiz Section -->
    <section id="quizSection" class="quiz-section">
      <h2>Chapter Quiz</h2>
      <div id="quizContainer">
        <!-- Quiz questions will be inserted here by chapter.js -->
      </div>
      <button onclick="submitQuiz()" class="action-btn">Submit Quiz</button>
      <div id="quizResult" class="quiz-result hidden"></div>
    </section>
    <!-- Related Chapters Section -->
    <section class="related-chapters">
      <h2>Related Chapters</h2>
      <div id="relatedChapters">
        <!-- Related chapters will be injected here by chapter.js -->
      </div>
    </section>
  </main>
  <!-- Footer -->
  <footer class="footer" id="pageEnd">
    <p>© 2025 LearnBite. All rights reserved.</p>
  </footer>
  <script>
    function toggleMenu() {
      var nav = document.getElementById('mainNav');
      nav.classList.toggle('active');
    }
  </script>
  <!-- Firebase Scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyA6At0_PeY351303P85_o0wtYMXGQ_d_xg",
      authDomain: "learnbite-e7673.firebaseapp.com",
      databaseURL: "https://learnbite-e7673-default-rtdb.firebaseio.com/",
      projectId: "learnbite-e7673",
      storageBucket: "learnbite-e7673.appspot.com",
      messagingSenderId: "897857889201",
      appId: "1:897857889201:web:c601789ccba7f1fe8b9390"
    };
    firebase.initializeApp(firebaseConfig);
    function updateChapterProgress() {
      const user = firebase.auth().currentUser;
      if (!user) return;
      const uid = user.uid;
      const subject = localStorage.getItem('currentSubject');
      const chapterIndex = parseInt(localStorage.getItem('currentChapterIndex'));
      const chapters = chaptersDatabase[subject];
      if (!chapters || chapterIndex === -1) return;
      const chapterTitle = chapters[chapterIndex].title;
      const progress = 100;
      const userRef = firebase.database().ref(`users/${uid}/subjects/${subject}`);
      userRef.once('value').then((snapshot) => {
        const userChapters = snapshot.val() || [];
        const dbChapterIndex = userChapters.findIndex(ch => ch.title === chapterTitle);
        if (dbChapterIndex > -1) {
          userRef.child(dbChapterIndex).update({ progress });
        } else {
          userRef.push({ title: chapterTitle, progress });
        }
      });
    }
    const footer = document.getElementById('pageEnd');
    if (footer) {
      new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            updateChapterProgress();
          }
        });
      }, { threshold: 0.1 }).observe(footer);
    }
  </script>
  <!-- Load chapter.js -->
  <script src="chapter.js"></script>
  <!-- Theme Initialization -->
  <script>
    function toggleMenu() {
  const mainNav = document.getElementById('mainNav');
  const menuToggle = document.querySelector('.menu-toggle');
  mainNav.classList.toggle('active');
  menuToggle.classList.toggle('active');
}
        // Theme Toggle
        function toggleDarkMode() {
        const body = document.body;
        const isDark = body.getAttribute('data-theme') === 'dark';
        body.setAttribute('data-theme', isDark ? 'light' : 'dark');
        localStorage.setItem('theme', isDark ? 'light' : 'dark');
        updateToggleButton(isDark);
    }

    function updateToggleButton(isDark) {
        const toggle = document.getElementById('themeToggle');
        toggle.textContent = isDark ? '🌓' : '🌞';
    }

    // Initialize theme
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.body.setAttribute('data-theme', savedTheme);
    updateToggleButton(savedTheme === 'dark');
    document.getElementById('themeToggle').addEventListener('click', toggleDarkMode);
  </script>
</body>
</html>
