<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PSEYPL9P20"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PSEYPL9P20');
</script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LearnBite - Smart Learning for CBSE</title>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900&display=swap');

    :root {
      --primary-color: #58cc02;
      --secondary-color: #1cb0f6;
      --accent-color: #ff6b6b;
      --text-color: #2d2d2d;
      --white: #ffffff;
      --bg-color: #f8f9fa;
      --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      --border-radius: 16px;
    }

    [data-theme="dark"] {
      --primary-color: #58cc02;
      --secondary-color: #1cb0f6;
      --accent-color: #ff6b6b;
      --text-color: #ffffff;
      --white: #111111;
      --bg-color: #000000;
      --card-shadow: 0 4px 12px rgba(192, 192, 192, 0.377);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Rubik', sans-serif;
    }

    body {
      background: var(--bg-color);
      color: var(--text-color);
      line-height: 1.5;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    /* Header */
    .header {
      position: sticky;
      top: 0;
      width: 100%;
      background: var(--white);
      box-shadow: var(--card-shadow);
      z-index: 1000;
      border-bottom: 3px solid var(--secondary-color);
    }

    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
      flex-wrap: wrap;
    }

    .logo {
      height: 50px;
      transition: transform 0.2s ease;
    }

    .logo:hover {
      transform: scale(1.05);
    }

    .menu-toggle {
      background: none;
      border: none;
      cursor: pointer;
      display: none;
      flex-direction: column;
      gap: 4px;
    }

    .menu-toggle .hamburger {
      width: 25px;
      height: 3px;
      background: var(--text-color);
      transition: all 0.3s ease;
    }

    .main_nav {
      background: var(--white);
    }

    .main_nav_list {
      display: flex;
      gap: 1.5rem;
      list-style: none;
      padding: 0 2rem 1rem;
      align-items: center;
      justify-content: center;
    }

    .main_nav_link {
      text-decoration: none;
      color: var(--text-color);
      font-weight: 500;
      padding: 0.75rem 1.25rem;
      border-radius: 50px;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      background: rgba(88, 204, 2, 0.05);
    }

    .main_nav_link:hover {
      background: rgba(88, 204, 2, 0.15);
      transform: translateY(-2px);
    }

    .larry_btn, .login_btn {
      background: var(--secondary-color);
      color: var(--white) !important;
      box-shadow: 0 3px 0 #0f8ecb;
      text-decoration: none;
      padding: 0.75rem 1.25rem;
      border-radius: 50px;
      cursor: pointer;
    }

    /* Theme Toggle */
    .theme-toggle {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.5rem;
      padding: 0.5rem;
      margin-left: auto;
      transition: transform 0.3s ease;
    }

    .theme-toggle:hover {
      transform: rotate(20deg);
    }

    /* Main Content */
    main {
      margin-top: 100px;
      padding: 2rem;
    }

    .dashboard {
      max-width: 1200px;
      margin: 0 auto;
    }

    /* Status Bar */
    .status-bar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }

    .status-card {
      background: var(--white);
      padding: 1.5rem;
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      display: flex;
      align-items: center;
      gap: 1rem;
      transition: transform 0.2s ease;
    }

    .status-card:hover {
      transform: translateY(-3px);
    }

    .status-icon {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
    }

    .streak-icon { background: #ffd700; }
    .gems-icon { background: #1cb0f6; color: white; }
    .progress-icon { background: #58cc02; color: white; }

    /* Subject Grid */
    .subject-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
      margin: 3rem 0;
    }

    .subject-card {
      background: var(--white);
      padding: 2rem;
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      position: relative;
      overflow: hidden;
      transition: transform 0.2s ease;
    }

    .subject-card:hover {
      transform: translateY(-5px);
    }

    .subject-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 8px;
      background: var(--subject-color);
    }

    .subject-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .subject-icon {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      background: rgba(88, 204, 2, 0.1);
    }

    /* Progress Circle */
    .progress-circle {
      width: 120px;
      height: 120px;
      margin: 1.5rem auto;
      position: relative;
    }

    .progress-circle svg {
      width: 100%;
      height: 100%;
    }

    .progress-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-weight: 700;
      font-size: 1.8rem;
      color: var(--subject-color);
    }

    /* Action Button */
    .action-btn {
      padding: 0.75rem 1.5rem;
      border-radius: 50px;
      border: none;
      background: var(--primary-color);
      color: white;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      width: 100%;
      justify-content: center;
      box-shadow: 0 3px 0 #3ca900;
    }

    .action-btn:hover {
      opacity: 0.9;
      transform: translateY(-2px);
    }

    /* Daily Challenge */
    .daily-challenge {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      border-radius: var(--border-radius);
      padding: 2.5rem;
      margin: 3rem 0;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .challenge-badge {
      background: var(--accent-color);
      color: white;
      padding: 0.5rem 1.5rem;
      border-radius: 50px;
      display: inline-block;
      margin-bottom: 1.5rem;
      font-weight: 600;
    }

    /* Achievements */
    .achievements-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 2rem;
      margin: 3rem 0;
    }

    .achievement-card {
      background: var(--white);
      padding: 1.5rem;
      border-radius: var(--border-radius);
      text-align: center;
      box-shadow: var(--card-shadow);
      transition: transform 0.2s ease;
    }

    .achievement-card:hover {
      transform: translateY(-3px);
    }

    .achievement-icon {
      font-size: 2.5rem;
      margin-bottom: 1rem;
    }

    /* Modals */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.644);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }

    .modal-overlay:not(.hidden) {
      display: flex;
    }

    .login-modal,
    .course-modal,
    .larry-modal-content {
      background: white;
      border-radius: 20px;
      padding: 2rem;
      width: 90%;
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
    }

    .larry-modal-content {
      max-width: 800px;
      height: 90vh;
      position: relative;
      overflow: hidden;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .close-modal {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
    }

    /* Leaderboard */
    .leaderboard-section {
      background: var(--white);
      padding: 2rem;
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      margin: 3rem 0;
    }

    .leaderboard-entries {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .leaderboard-entry {
      display: flex;
      align-items: center;
      padding: 1rem;
      background: var(--bg-color);
      border-radius: var(--border-radius);
      transition: transform 0.2s ease;
    }

    .leaderboard-entry:hover {
      transform: translateX(5px);
    }

    .rank {
      font-weight: 600;
      width: 40px;
      text-align: center;
      color: var(--secondary-color);
    }

    .username {
      flex: 1;
      font-weight: 500;
    }

    .grade {
      margin: 0 1rem;
      color: var(--text-color);
      opacity: 0.8;
    }

    .gems {
      font-weight: 600;
      color: var(--primary-color);
    }

    /* Dark Mode Overrides */
    [data-theme="dark"] .ad-container,
    [data-theme="dark"] .status-card,
    [data-theme="dark"] .subject-card,
    [data-theme="dark"] .achievement-card,
    [data-theme="dark"] .leaderboard-section {
      background: var(--white);
      border-color: #333333;
    }

    [data-theme="dark"] .main_nav_link {
      background: rgb(45, 105, 161);
    }

    [data-theme="dark"] .main_nav_link:hover {
      background: rgba(63, 150, 209, 0.2);
    }

    [data-theme="dark"] .daily-challenge {  
      background: linear-gradient(135deg, #2b5802, #0a5a7a);
    }

    [data-theme="dark"] .footer {
      background: linear-gradient(135deg, #737779, #2b5802);
    }

    [data-theme="dark"] input,
    [data-theme="dark"] select,
    [data-theme="dark"] textarea {
      background: #333 !important;
      color: var(--text-color) !important;
      border: 1px solid #444 !important;
    }

    [data-theme="dark"] .colorherefr {
      color: black !important;
    }

    [data-theme="dark"] .progress-circle path:first-child {
      stroke: #333333;
    }

    [data-theme="dark"] .modal-header {
      background: #121212;
      border-bottom: 1px solid #333333;
    }

    [data-theme="dark"] .leaderboard-entry {
      background: #1a1a1a;
    }

    [data-theme="dark"] .hamburger {
      background: var(--text-color);
    }

    [data-theme="dark"] .login-modal,
    [data-theme="dark"] .course-modal,
    [data-theme="dark"] .larry-modal-content {
      background: #121212;
      color: var(--text-color);
    }

    [data-theme="dark"] .close-modal {
      color: #888;
    }

    [data-theme="dark"] .close-modal:hover {
      color: var(--text-color);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .header-container {
        padding: 0.75rem 1rem;
      }
      .menu-toggle {
        display: flex;
      }
      .main_nav_list {
        flex-direction: column;
        gap: 1rem;
        padding: 0 1rem 1rem;
      }
      .main_nav {
        display: none;
      }
      .main_nav.active {
        display: block;
      }
      .logo {
        height: 40px;
      }
      .subject-grid {
        grid-template-columns: 1fr;
      }
      .status-bar {
        grid-template-columns: 1fr;
      }
      .daily-challenge {
        padding: 1.5rem;
      }
    }

    @media (max-width: 480px) {
      .header-container {
        flex-direction: column;
      }
      .subject-card {
        padding: 1rem;
      }
      .progress-circle {
        width: 100px;
        height: 100px;
      }
      .status-card {
        flex-direction: column;
        text-align: center;
      }
    }
    /* Footer */
.footer {
  background: linear-gradient(135deg, #1CB0F6, #58CC02);
  color: #fff;
  text-align: center;
  padding: 2rem 1rem;
  margin-top: 2rem;
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.15);
  font-size: 1.1rem;
}

.footer-container {
  max-width: 1200px;
  margin: 0 auto;
}

.footer p {
  margin: 0;
  padding-bottom: 0.5rem;
}

.footer .social-icons {
  margin-top: 1rem;
}

.footer .social-icons a {
  color: #fff;
  margin: 0 0.5rem;
  font-size: 1.5rem;
  text-decoration: none;
  transition: color 0.3s ease;
}

.footer .social-icons a:hover {
  color: #FF6B6B;
}

/* Dark Mode Footer */
[data-theme="dark"] .footer {
  background: linear-gradient(135deg, #0a5a7a, #2b5802);
}
/* Remove close modal button from bottom */
#logoutModal.modal {
  display: none !important;
}

/* Hide close button by default */
.close-modal {
  display: none;
  position: absolute;
  top: 15px;
  right: 20px;
}

/* Show close button when modal is open */
.modal-overlay:not(.hidden) .close-modal {
  display: block;
}

/* Adjust modal header padding */
.modal-header {
  padding-right: 50px; /* Make space for close button */
}


/* Close button styling */
.close-modal {
  background: none;
  border: none;
  color: var(--text-color);
  font-size: 2rem;
  cursor: pointer;
  transition: opacity 0.2s ease;
  z-index: 3000;
  position: absolute;
  top: 15px;
  right: 20px;
}

.close-modal:hover {
  opacity: 0.8;
}

/* Dark mode close button */
[data-theme="dark"] .close-modal {
  color: #ffffff;
}
/* Mobile-specific styling */
@media (max-width: 768px) {
  .header-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 1rem;
  }
  
  /* Show the hamburger icon */
  .menu-toggle {
    display: flex;
    flex-direction: column;
    gap: 4px;
    background: none;
    border: none;
    cursor: pointer;
    transition: transform 0.3s ease;
  }
  
  /* Style each line of the hamburger */
  .menu-toggle .hamburger {
    width: 25px;
    height: 3px;
    background: var(--text-color);
    transition: all 0.3s ease;
  }
  
  /* Animate hamburger to close icon when active */
  .menu-toggle.active .hamburger:nth-child(1) {
    transform: translateY(7px) rotate(45deg);
  }
  .menu-toggle.active .hamburger:nth-child(2) {
    opacity: 0;
  }
  .menu-toggle.active .hamburger:nth-child(3) {
    transform: translateY(-7px) rotate(-45deg);
  }
  
  /* Mobile nav overlay styling */
  .main_nav {
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    background: var(--white);
    box-shadow: var(--card-shadow);
    transition: transform 0.3s ease, opacity 0.3s ease;
    transform: translateY(-20px);
    opacity: 0;
    pointer-events: none;
  }
  
  /* When active, the nav slides in */
  .main_nav.active {
    transform: translateY(0);
    opacity: 1;
    pointer-events: auto;
  }
  
  /* Stack the nav links vertically with larger touch targets */
  .main_nav_list {
    flex-direction: column;
    gap: 1rem;
    padding: 1rem;
  }
  
  .main_nav_link {
    padding: 1rem;
    font-size: 1.2rem;
    border-radius: 8px;
    transition: background 0.2s ease, transform 0.2s ease;
  }
  
  .main_nav_link:hover {
    background: rgba(88, 204, 2, 0.15);
    transform: translateY(-2px);
  }
}
@media (max-width: 768px) {
  .header-container {
    flex-direction: row;
  }

  .logo {
    height: 40px;
    margin-right: auto;
  }

  .header-right {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .menu-toggle {
    display: flex;
    flex-direction: column;
    gap: 4px;
    background: none;
    border: none;
    cursor: pointer;
  }

  .menu-toggle .hamburger {
    width: 25px;
    height: 3px;
    background: var(--text-color);
    transition: all 0.3s ease;
  }

  /* Animate hamburger into close icon */
  .menu-toggle.active .hamburger:nth-child(1) {
    transform: translateY(7px) rotate(45deg);
  }

  .menu-toggle.active .hamburger:nth-child(2) {
    opacity: 0;
  }

  .menu-toggle.active .hamburger:nth-child(3) {
    transform: translateY(-7px) rotate(-45deg);
  }

  /* Mobile Nav Overlay */
  .main_nav {
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    background: var(--white);
    box-shadow: var(--card-shadow);
    transition: transform 0.3s ease, opacity 0.3s ease;
    transform: translateY(-20px);
    opacity: 0;
    pointer-events: none;
  }

  .main_nav.active {
    transform: translateY(0);
    opacity: 1;
    pointer-events: auto;
  }

  /* Align navigation to the left */
  .main_nav_list {
    flex-direction: column;
    gap: 1rem;
    padding: 1rem;
    align-items: flex-start; /* Left-align items */
  }

  .main_nav_link {
    padding: 1rem;
    font-size: 1.2rem;
    border-radius: 8px;
    transition: background 0.2s ease, transform 0.2s ease;
  }

  .main_nav_link:hover {
    background: rgba(88, 204, 2, 0.15);
    transform: translateY(-2px);
  }

  /* Make login button fit better in mobile */
  .login_btn {
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
  }

}
.chat-container {
      background: var(--white);
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      padding: 1rem;
      margin-top: 1rem;
    }
  
    .chat-message {
      background: rgba(88, 204, 2, 0.1);
      padding: 0.8rem;
      border-radius: 1rem;
      margin: 0.5rem 0;
      max-width: 70%;
    }
  
    .chat-message.self {
      background: var(--primary-color);
      color: white;
      margin-left: auto;
    }
  
    /* Notifications */
    .notification-bell {
      position: relative;
      cursor: pointer;
    }
  
    .notification-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background: var(--accent-color);
      color: white;
      border-radius: 50%;
      padding: 2px 6px;
      font-size: 0.8rem;
    }
  
    .notifications-dropdown {
      position: absolute;
      right: 0;
      top: 100%;
      background: var(--white);
      box-shadow: var(--card-shadow);
      border-radius: var(--border-radius);
      padding: 1rem;
      width: 300px;
      max-height: 400px;
      overflow-y: auto;
      display: none;
    }   

        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
        }

        iframe {
            width: 100%;
            height: 500px;
            border: none;
        }

        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        button:hover {
            background-color: #45a049;
        }
        /* Add these styles to your existing CSS */
#larryModal .larry-modal-content {
  display: flex;
  flex-direction: column;
  width: 90%;
  max-width: 800px;
  height: 90vh;
  padding: 0; /* Remove padding to prevent iframe overflow */
}

#larryModal iframe {
  flex: 1; /* Fill remaining space */
  width: 100%;
  height: calc(100% - 40px); /* Account for close button */
  margin-top: 40px; /* Space for close button */
}

#larryModal .close-modal {
  top: 15px;
  right: 15px;
  z-index: 1; /* Ensure it's above iframe */
}
</style>
</head>
<body>
        <!-- Modal container -->
      <div class="modal-overlay hidden" id="larryModal">
        <div class="larry-modal-content">
          <button class="close-modal" onclick="closeLarryModal()">√ó</button>
          <iframe id="larryFrame" src="" style="width:100%; height:100%; border:0;"></iframe>
        </div>
      </div>
  <!-- Login Modal -->
  <div class="modal-overlay hidden" id="loginModal">
    <div class="login-modal">
      <div class="modal-header">
        <h2>Login</h2>
        <button class="close-modal" onclick="closeLoginModal()">√ó</button>
      </div>
      <form id="loginForm">
        <div style="margin-bottom: 1rem;">
          <label for="email">Email:</label>
          <input type="email" id="email" name="email" required style="width: 100%; padding: 0.5rem; margin-top: 0.5rem;" />
        </div>
        <div style="margin-bottom: 1rem;">
          <label for="password">Password:</label>
          <input type="password" id="password" name="password" required style="width: 100%; padding: 0.5rem; margin-top: 0.5rem;" />
        </div>
        <button type="submit" class="action-btn" style="margin-bottom: 1rem;">Login</button>
      </form>
      <div style="text-align: center;">
        <p>Don't have an account?</p>
        <button class="action-btn" onclick="openRegisterModal()">Register</button>
      </div>
    </div>
  </div>

  <!-- Register Modal -->
  <div class="modal-overlay hidden" id="registerModal">
    <div class="login-modal">
      <div class="modal-header">
        <h2>Register</h2>
        <button class="close-modal" onclick="closeRegisterModal()">√ó</button>
      </div>
      <form id="registerForm">
        <div style="margin-bottom: 1rem;">
          <label for="regEmail">Email:</label>
          <input type="email" id="regEmail" name="regEmail" required style="width: 100%; padding: 0.5rem; margin-top: 0.5rem;" />
        </div>
        <div style="margin-bottom: 1rem;">
          <label for="regPassword">Password:</label>
          <input type="password" id="regPassword" name="regPassword" required style="width: 100%; padding: 0.5rem; margin-top: 0.5rem;" />
        </div>
        <div style="margin-bottom: 1rem;">
          <label for="regGrade">Select Grade:</label>
          <select id="regGrade" name="regGrade" required style="width: 100%; padding: 0.5rem; margin-top: 0.5rem;">
            <option value="">--Choose Grade--</option>
            <option value="9">Grade 9</option>
            <option value="10">Grade 10</option>
            <option value="11">Grade 11</option>
            <option value="12">Grade 12</option>
          </select>
        </div>
        <button type="submit" class="action-btn" style="margin-bottom: 1rem;">Register</button>
      </form>
      <div style="text-align: center;">
        <p>Already have an account?</p>
        <button class="action-btn" onclick="openLoginModal()">Login</button>
      </div>
    </div>
  </div>

  <!-- Chapters Modal (for chapter selection) -->
  <div class="modal-overlay hidden" id="chaptersModal">
    <div class="course-modal">
      <div class="modal-header">
        <h2 class="modal-title" id="modalSubject"></h2>
        <button class="close-modal" onclick="closeChaptersModal()">√ó</button>
      </div>
      <div id="chaptersPath">
        <!-- Chapters will be dynamically injected here -->
      </div>
    </div>
  </div>



  <!-- Header with Menu -->
  <header class="header">
    <div class="header-container">
      <p><a href="https://sinanneedtocode.github.io/LearnBite">
        <img src="imgs/duolingo-landscape-lockup.png" alt="LearnBite Logo" class="logo">
      </a>
        </p>
      <div class="header-right">
        <button id="themeToggle" class="theme-toggle">üåì</button>
        <button class="login_btn" onclick="openLoginModal()">Login</button>
        <button class="menu-toggle" onclick="toggleMenu()">
          <span class="hamburger"></span>
          <span class="hamburger"></span>
          <span class="hamburger"></span>
        </button>
      </div>
    </div>
    <nav class="main_nav" id="mainNav">
      <ul class="main_nav_list">
        <li><a href="#home" class="main_nav_link">üè† Home</a></li>
        <li><a href="#" class="main_nav_link" onclick="openLarryModal()">ü¶â Ask Larry</a></li>
        <li><a href="timer.html" class="main_nav_link larry_btn">‚è±Ô∏è Study Companion</a></li>
        <li><a href="profile.html" class="main_nav_link">üë§ Profile</a></li>
        <li><a href="mission.html" class="main_nav_link">Games</a></li>
      </ul>
    </nav>
  </header>
  



  <!-- Main Content -->
  <main class="dashboard">
    <div class="status-bar">
      <div class="status-card">
        <div class="status-icon streak-icon">üî•</div>
        <div>
          <h3 id="streakCount">0-Day Streak</h3>
          <p>Keep it going!</p>
        </div>
      </div>
      <div class="status-card">
        <div class="status-icon gems-icon">üíé</div>
        <div>
          <h3><span id="gemCount">0</span> Gems</h3>
          <p>Redeem rewards</p>
        </div>
      </div>
    </div>

    <div class="subject-grid">
      <!-- Mathematics Subject Card -->
      <div class="subject-card" style="--subject-color: #ff6b6b;" data-subject="mathematics">
        <div class="subject-header">
          <div class="subject-icon">üßÆ</div>
          <h2>Mathematics</h2>
        </div>
        <div class="progress-circle">
          <svg viewBox="0 0 36 36">
            <path
              d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
              fill="none"
              stroke="#eee"
              stroke-width="3" />
            <path
              d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
              fill="none"
              stroke="var(--subject-color)"
              stroke-width="3"
              stroke-dasharray="0, 100" />
          </svg>
          <div class="progress-text">0%</div>
        </div>
        <button class="action-btn explore-btn">Explore Chapters ‚Üí</button>
      </div>

      <!-- Science Subject Card -->
      <div class="subject-card" style="--subject-color: #1cb0f6;" data-subject="science">
        <div class="subject-header">
          <div class="subject-icon">üî¨</div>
          <h2>Science</h2>
        </div>
        <div class="progress-circle">
          <svg viewBox="0 0 36 36">
            <path
              d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
              fill="none"
              stroke="#eee"
              stroke-width="3" />
            <path
              d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
              fill="none"
              stroke="var(--subject-color)"
              stroke-width="3"
              stroke-dasharray="0, 100" />
          </svg>
          <div class="progress-text">0%</div>
        </div>
        <button class="action-btn explore-btn">Explore Chapters ‚Üí</button>
      </div>
      <!-- English Subject Card -->
      <div class="subject-card" style="--subject-color: #c6ff6b;" data-subject="english">
        <div class="subject-header">
          <div class="subject-icon">üìö</div>
          <h2>English</h2>
        </div>
        <div class="progress-circle">
          <svg viewBox="0 0 36 36">
            <path
              d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
              fill="none"
              stroke="#eee"
              stroke-width="3" />
            <path
              d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
              fill="none"
              stroke="var(--subject-color)"
              stroke-width="3"
              stroke-dasharray="0, 100" />
          </svg>
          <div class="progress-text">0%</div>
        </div>
        <button class="action-btn explore-btn">Explore Chapters ‚Üí</button>
      </div>
    </div>
    <div class="subject-card" style="--subject-color: #725555;" data-subject="social_science">
      <div class="subject-header">
        <div class="subject-icon">üßÆ</div>
        <h2>social</h2>
      </div>
      <div class="progress-circle">
        <svg viewBox="0 0 36 36">
          <path
            d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
            fill="none"
            stroke="#eee"
            stroke-width="3" />
          <path
            d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
            fill="none"
            stroke="var(--subject-color)"
            stroke-width="3"
            stroke-dasharray="0, 100" />
        </svg>
        <div class="progress-text">0%</div>
      </div>
      <button class="action-btn explore-btn">Explore Chapters ‚Üí</button>
    </div>

    <section class="daily-challenge">
      <span class="challenge-badge">Daily Challenge! üéâ</span>
      <h2>Solve 5 Math Problems in 10 Minutes</h2>
      <p>Earn 2x Gems and a Special Badge!</p>
      <button class="action-btn" style="margin-top: 1.5rem; background: var(--accent-color);"
        onclick="window.location.href='challenge.html'">
        üöÄ Start Challenge
      </button>
    </section>

    <!-- Ad Container -->
    <div class="ad-container">
      <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX"
         crossorigin="anonymous"></script>
      <!-- LearnBite Ad Unit -->
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
           data-ad-slot="1234567890"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
           (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>

    <section class="achievements-section">
      <div class="achievement-card">
        <div class="achievement-icon">üèÜ</div>
        <h3>Rookie Learner</h3>
        <p>Complete 10 lessons</p>
      </div>
      <div class="achievement-card">
        <div class="achievement-icon">üéñÔ∏è</div>
        <h3>Week Warrior</h3>
        <p>7-day streak</p>
      </div>
      <div class="achievement-card">
        <div class="achievement-icon">üí°</div>
        <h3>Quick Thinker</h3>
        <p>50 fast answers</p>
      </div>
    </section>
  </main>

  <section class="leaderboard-section">
  <div class="leaderboard-header">
    <h2>üèÜ Leaderboard</h2>
    <br>
  </div>
  <div id="leaderboardEntries" class="leaderboard-entries">
    <!-- Entries will be dynamically added here -->
  </div>
</section>
  <!-- Footer -->
  <footer class="footer">
    <div class="footer-container">
      <p>¬© 2025 LearnBite. All rights reserved.</p>
    </div>
  </footer>

  <script>
    // Progress tracking functions
    function calculateSubjectProgress(chapters) {
        if (!chapters || chapters.length === 0) return 0;
        const totalProgress = chapters.reduce((sum, chapter) => sum + (chapter.progress || 0), 0);
        return Math.round((totalProgress / (chapters.length * 100)) * 100);
    }

    function updateProgressCircle(element, progress) {
        const circle = element.querySelector('path:last-child');
        const text = element.querySelector('.progress-text');
        if (circle && text) {
            circle.setAttribute('stroke-dasharray', `${progress}, 100`);
            text.textContent = `${progress}%`;
        }
    }

    function initializeProgress(uid) {
        const subjectsRef = firebase.database().ref(`users/${uid}/subjects`);
        
        subjectsRef.once('value').then((snapshot) => {
            const userSubjects = snapshot.val() || {};
            const updates = {};

            Object.keys(chaptersDatabase).forEach(subject => {
                const dbChapters = chaptersDatabase[subject];
                const userChapters = userSubjects[subject] || [];
                
                // Create map of existing chapter titles
                const existingTitles = new Set(userChapters.map(ch => ch.title));
                
                // Identify new chapters
                const newChapters = dbChapters.filter(dbCh => 
                    !existingTitles.has(dbCh.title)
                ).map(ch => ({ title: ch.title, progress: 0 }));

                if (newChapters.length > 0) {
                    updates[subject] = [...userChapters, ...newChapters];
                } else if (!userSubjects[subject]) {
                    updates[subject] = dbChapters.map(ch => ({ title: ch.title, progress: 0 }));
                }
            });

            if (Object.keys(updates).length > 0) {
                subjectsRef.update(updates);
            }
        });
    }

    function checkForChapterUpdates(uid) {
        const subjectsRef = firebase.database().ref(`users/${uid}/subjects`);
        
        subjectsRef.once('value').then((snapshot) => {
            const userSubjects = snapshot.val() || {};
            const updates = {};

            Object.keys(chaptersDatabase).forEach(subject => {
                const dbChapters = chaptersDatabase[subject];
                const userChapters = userSubjects[subject] || [];
                
                const existingTitles = new Set(userChapters.map(ch => ch.title));
                const newChapters = dbChapters.filter(dbCh => 
                    !existingTitles.has(dbCh.title)
                ).map(ch => ({ title: ch.title, progress: 0 }));

                if (newChapters.length > 0) {
                    updates[subject] = [...userChapters, ...newChapters];
                }
            });

            if (Object.keys(updates).length > 0) {
                subjectsRef.update(updates).then(() => {
                    console.log('New chapters added for user:', uid);
                });
            }
        });
    }

    function listenToProgressUpdates(uid) {
        const subjectsRef = firebase.database().ref(`users/${uid}/subjects`);
        
        subjectsRef.on('value', (snapshot) => {
            const subjects = snapshot.val() || {};
            
            Object.keys(subjects).forEach(subject => {
                const progress = calculateSubjectProgress(subjects[subject]);
                const subjectCard = document.querySelector(`[data-subject="${subject}"]`);
                if (subjectCard) {
                    const progressCircle = subjectCard.querySelector('.progress-circle');
                    updateProgressCircle(progressCircle, progress);
                }
            });
        });
    }
        // Function to open the Larry modal
        function openLarryModal() {
            // Get the modal element
            const modal = document.getElementById('larryModal');
            
            // Get the iframe element
            const iframe = document.getElementById('larryFrame');
            
            // Set the iframe src to larry.html
            iframe.src = 'larry.html';
            
            // Display the modal
            modal.style.display = 'block';
        }
        
        // Function to close the Larry modal
        function closeLarryModal() {
            // Get the modal element
            const modal = document.getElementById('larryModal');
            
            // Get the iframe element
            const iframe = document.getElementById('larryFrame');
            
            // Clear the iframe src
            iframe.src = '';
            
            // Hide the modal
            modal.style.display = 'none';
        }
        
        // Close the modal if the user clicks outside of it
        window.onclick = function(event) {
            const modal = document.getElementById('larryModal');
            if (event.target == modal) {
                closeLarryModal();
            }
        }
    function updateChapterProgress(uid, subject, chapterTitle, progress) {
        const chapterRef = firebase.database()
            .ref(`users/${uid}/subjects/${subject}`)
            .orderByChild('title')
            .equalTo(chapterTitle);

        chapterRef.once('value', (snapshot) => {
            snapshot.forEach((childSnapshot) => {
                childSnapshot.ref.update({ progress: progress });
            });
        });
    }
        // Games Modal Functions
    window.openGamesModal = function() {
      document.getElementById('gamesModal').classList.remove('hidden');
    }

    window.closeGamesModal = function() {
      document.getElementById('gamesModal').classList.add('hidden');
    }
    // Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyA6At0_PeY351303P85_o0wtYMXGQ_d_xg",
        authDomain: "learnbite-e7673.firebaseapp.com",
        databaseURL: "https://learnbite-e7673-default-rtdb.firebaseio.com/",
        projectId: "learnbite-e7673",
        storageBucket: "learnbite-e7673.firebasestorage.app",
        messagingSenderId: "897857889201",
        appId: "1:897857889201:web:c601789ccba7f1fe8b9390"
    };
    firebase.initializeApp(firebaseConfig);

    // Authentication and Database Handlers
    document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('email').value.trim();
        const password = document.getElementById('password').value.trim();
        firebase.auth().signInWithEmailAndPassword(email, password)
            .then((userCredential) => {
                closeLoginModal();
            })
            .catch((error) => {
                alert("Login Error: " + error.message);
            });
    });

    document.getElementById('registerForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('regEmail').value.trim();
        const password = document.getElementById('regPassword').value.trim();
        const grade = document.getElementById('regGrade').value;
        if (password.length < 6) {
            alert("Password must be at least 6 characters long.");
            return;
        }
        firebase.auth().createUserWithEmailAndPassword(email, password)
            .then((userCredential) => {
                const uid = userCredential.user.uid;
                firebase.database().ref('users/' + uid).set({
                    points: 0,
                    streak: 1,
                    grade: grade,
                    email: email
                });
                closeRegisterModal();
            })
            .catch((error) => {
                alert("Registration Error: " + error.message);
            });
    });

    function updateUserData(user) {
        const uid = user.uid;
        const userRef = firebase.database().ref('users/' + uid);
        userRef.on('value', (snapshot) => {
            const data = snapshot.val();
            if (data) {
                document.getElementById('gemCount').textContent = data.points || 0;
                document.getElementById('streakCount').textContent = (data.streak || 0) + "-Day Streak";
            }
        });
    }

    // Auth State Listener with Chapter Sync
    firebase.auth().onAuthStateChanged(user => {
        const loginBtn = document.querySelector('.login_btn');
        if (user) {
            updateUserData(user);
            updateStreak(user);
            initializeProgress(user.uid);
            checkForChapterUpdates(user.uid);
            listenToProgressUpdates(user.uid);
            loginBtn.textContent = "Logout";
            loginBtn.onclick = function() {
                firebase.auth().signOut().then(() => {
                    alert("Logged out successfully");
                }).catch(error => {
                    alert("Error signing out: " + error.message);
                });
            };
        } else {
            loginBtn.textContent = "Login";
            loginBtn.onclick = openLoginModal;
        }
    });

    // Chapters Database
    const chaptersDatabase = {
        science: [
            { title: "Structure of Atom", progress: 0 },
            { title: "Motion", progress: 0 },
            { title: "Tissues", progress: 0 },
            { title: "Atoms and Molecules", progress: 0 },
            { title: "Structure of the Atom", progress: 0 },
            { title: "The Fundamental Unit of Life", progress :0},
        ],
        mathematics: [
            { title: "Linear Equations", progress: 0 },
            { title: "Number Systems", progress: 0 },
            { title: "Polynomials", progress: 0 },
            { title: "Lines and Angles", progress:0}
        ],
        english: [
            { title: "The Fun They Had", progress: 0 },
            { title: "The Road Not Taken", progress: 0 },
            { title:"The Lost Child",progress:0}
        ],
        social_science: [
            { title: "The French Revolution", progress: 0 },
            { title: "Socialism in Europe and the Russian Revolution", progress: 0 },
            { title: "Nazisam and the Rise of Hitler", progress: 0 }  
        ],
    };

    // Rest of the application logic
    function updateStreak(user) {
        const today = new Date().toISOString().slice(0, 10);
        const uid = user.uid;
        const userRef = firebase.database().ref('users/' + uid);

        userRef.once('value').then((snapshot) => {
            const userData = snapshot.val();
            let streak = userData.streak || 0;
            const lastVisit = userData.lastVisit || '';

            if (!lastVisit) {
                streak = 1;
            } else if (lastVisit === today) {
                // Already visited today
            } else {
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                const yesterdayStr = yesterday.toISOString().slice(0, 10);

                if (lastVisit === yesterdayStr) {
                    streak += 1;
                } else {
                    streak = 1;
                }
            }

            userRef.update({
                streak: streak,
                lastVisit: today
            }).then(() => {
                document.getElementById('streakCount').textContent = streak + "-Day Streak";
            });
        });
    }

    // Modal Functions
    window.openLoginModal = function() {
        document.getElementById('loginModal').classList.remove('hidden');
        document.getElementById('registerModal').classList.add('hidden');
    }

    window.closeLoginModal = function() {
        document.getElementById('loginModal').classList.add('hidden');
    }

    window.openRegisterModal = function() {
        document.getElementById('registerModal').classList.remove('hidden');
        document.getElementById('loginModal').classList.add('hidden');
    }

    window.closeRegisterModal = function() {
        document.getElementById('registerModal').classList.add('hidden');
    }

    window.toggleMenu = function() {
      const mainNav = document.getElementById('mainNav');
  const menuToggle = document.querySelector('.menu-toggle');
  mainNav.classList.toggle('active');
  menuToggle.classList.toggle('active');
    }

    // Chapter Modal Logic
    window.showChaptersModal = function(subject) {
        const modal = document.getElementById('chaptersModal');
        const pathContainer = document.getElementById('chaptersPath');
        const user = firebase.auth().currentUser;
        document.body.style.overflow = 'hidden'; 
        
        if (!user) {
            alert('Please login to view chapters');
            openLoginModal();
            return;
        }

        const subjectRef = firebase.database().ref(`users/${user.uid}/subjects/${subject}`);
        
        subjectRef.once('value').then((snapshot) => {
            const chapters = snapshot.val() || chaptersDatabase[subject];
            pathContainer.innerHTML = '';
            
            chapters.forEach((chapter, index) => {
                const chapterEl = document.createElement('div');
                chapterEl.style.margin = '1rem 0';
                chapterEl.style.padding = '1.5rem';
                chapterEl.style.backgroundColor = 'white';
                chapterEl.style.borderRadius = 'var(--border-radius)';
                chapterEl.style.boxShadow = 'var(--card-shadow)';
                
                const progressBarWidth = chapter.progress || 0;
                
                chapterEl.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div style="width: 40px; height: 40px; border-radius: 50%; 
                                      background: ${chapter.progress === 100 ? 'var(--primary-color)' : 'white'}; 
                                      border: 2px solid var(--primary-color); 
                                      display: flex; align-items: center; 
                                      justify-content: center; 
                                      color: ${chapter.progress === 100 ? 'white' : 'var(--primary-color)'}">
                                ${chapter.progress === 100 ? '‚úì' : (index + 1)}
                            </div>
                            <div>
                                <h4 class="colorherefr" style="font-weight: 600; margin-bottom: 0.5rem;">${chapter.title}</h4>
                                <div style="width: 200px; height: 8px; background: #eee; border-radius: 4px; overflow: hidden;">
                                    <div style="width: ${progressBarWidth}%; height: 100%; background: var(--primary-color);"></div>
                                </div>
                            </div>
                        </div>
                        <a href="chapter.html?subject=${subject}&chapter=${encodeURIComponent(chapter.title)}" 
                           class="action-btn" style="margin: 0; padding: 0.5rem 1rem;">
                            ${chapter.progress === 0 ? 'Start' : chapter.progress === 100 ? 'Review' : 'Continue'}
                        </a>
                    </div>
                `;
                pathContainer.appendChild(chapterEl);
            });
            
            modal.classList.remove('hidden');
            document.getElementById('modalSubject').textContent = 
                `${subject.charAt(0).toUpperCase() + subject.slice(1)} Learning Path`;
        });
    }

    // Initialize explore buttons
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.explore-btn').forEach(button => {
            button.addEventListener('click', function() {
                const subject = this.closest('.subject-card').dataset.subject;
                showChaptersModal(subject);
            });
        });
    });

    // Theme Toggle
    function toggleDarkMode() {
        const body = document.body;
        const isDark = body.getAttribute('data-theme') === 'dark';
        body.setAttribute('data-theme', isDark ? 'light' : 'dark');
        localStorage.setItem('theme', isDark ? 'light' : 'dark');
        updateToggleButton(isDark);
    }

    function updateToggleButton(isDark) {
        const toggle = document.getElementById('themeToggle');
        toggle.textContent = isDark ? 'üåì' : 'üåû';
    }

    // Initialize theme
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.body.setAttribute('data-theme', savedTheme);
    updateToggleButton(savedTheme === 'dark');
    document.getElementById('themeToggle').addEventListener('click', toggleDarkMode);

    // Leaderboard
    window.updateLeaderboard = function() {
        const leaderboardEntries = document.getElementById('leaderboardEntries');
        leaderboardEntries.innerHTML = '<div class="loading">Loading leaderboard...</div>';

        firebase.database().ref('users').once('value').then(snapshot => {
            const users = [];
            snapshot.forEach(userSnapshot => {
                const userData = userSnapshot.val();
                const email = userData.email || '';
                const username = email.split('@')[0] || 'Anonymous';
                users.push({
                    username: username,
                    grade: userData.grade || 'N/A',
                    gems: userData.points || 0,
                });
            });

            users.sort((a, b) => b.gems - a.gems);
            leaderboardEntries.innerHTML = '';
            users.forEach((user, index) => {
                const entry = document.createElement('div');
                entry.className = 'leaderboard-entry';
                entry.innerHTML = `
                    <div class="rank">${index + 1}</div>
                    <div class="username">${user.username}</div>
                    <div class="grade">Grade ${user.grade}</div>
                    <div class="gems">üíé ${user.gems}</div>
                `;
                leaderboardEntries.appendChild(entry);
            });
        }).catch(error => {
            leaderboardEntries.innerHTML = '<div class="error">Error loading leaderboard</div>';
            console.error('Leaderboard error:', error);
        });
    }
// Add this function if not existing
function closeChaptersModal() {
  const modal = document.getElementById('chaptersModal');
  if (modal) {
    modal.classList.add('hidden');
    document.body.style.overflow = 'auto'; // Restore scrolling
  }
}
    window.addEventListener('load', updateLeaderboard);
    let currentChatUser = null;
  
    function openChatModal() {
      if(!firebase.auth().currentUser) {
        alert('Please login to chat!');
        return;
      }
      document.getElementById('chatModal').classList.remove('hidden');
      loadUserList();
      setupChatListeners();
    }
  
    async function loadUserList() {
      const snapshot = await firebase.database().ref('users').once('value');
      const currentUID = firebase.auth().currentUser.uid;
      let html = '<h3>Online Users:</h3>';
      
      snapshot.forEach(user => {
        if(user.key !== currentUID) {
          html += `<div class="user-item" onclick="startChat('${user.key}')">
            ${user.val().email.split('@')[0]}
          </div>`;
        }
      });
      
      document.getElementById('userList').innerHTML = html;
    }
  
    function startChat(uid) {
      currentChatUser = uid;
      document.getElementById('chatMessages').innerHTML = '';
      setupChatListeners();
    }
  
    function setupChatListeners() {
      const currentUser = firebase.auth().currentUser;
      if(!currentUser || !currentChatUser) return;
  
      const chatRef = firebase.database().ref(`chats/${getChatId(currentUser.uid, currentChatUser)}`);
      
      chatRef.orderByChild('timestamp').limitToLast(50).on('value', snapshot => {
        const messages = [];
        snapshot.forEach(msg => {
          messages.push(msg.val());
        });
        
        let html = '';
        messages.forEach(msg => {
          const isSelf = msg.sender === currentUser.uid;
          html += `<div class="chat-message ${isSelf ? 'self' : ''}">
            <p>${msg.text}</p>
            <small>${new Date(msg.timestamp).toLocaleTimeString()}</small>
          </div>`;
        });
        
        document.getElementById('chatMessages').innerHTML = html;
      });
    }
  
    function getChatId(uid1, uid2) {
      return [uid1, uid2].sort().join('_');
    }
  
    function sendMessage() {
      const text = document.getElementById('messageInput').value.trim();
      if(!text || !currentChatUser) return;
  
      const currentUser = firebase.auth().currentUser;
      const chatRef = firebase.database().ref(`chats/${getChatId(currentUser.uid, currentChatUser)}`);
      
      chatRef.push({
        sender: currentUser.uid,
        receiver: currentChatUser,
        text: text,
        timestamp: Date.now()
      });
  
      // Send notification
      firebase.database().ref(`notifications/${currentChatUser}`).push({
        type: 'message',
        from: currentUser.uid,
        text: `New message from ${currentUser.email.split('@')[0]}`,
        timestamp: Date.now(),
        read: false
      });
  
      document.getElementById('messageInput').value = '';
    }
  
    // Notifications System
    function setupNotifications() {
      const user = firebase.auth().currentUser;
      if(!user) return;
  
      firebase.database().ref(`notifications/${user.uid}`).on('value', snapshot => {
        let count = 0;
        const notifications = [];
        
        snapshot.forEach(notif => {
          if(!notif.val().read) count++;
          notifications.push(notif.val());
        });
        
        document.getElementById('notificationCount').textContent = count;
        renderNotifications(notifications);
      });
    }
  
    function renderNotifications(notifications) {
      let html = '';
      notifications.forEach(notif => {
        html += `<div class="notification-item">
          <p>${notif.text}</p>
          <small>${new Date(notif.timestamp).toLocaleString()}</small>
        </div>`;
      });
      document.getElementById('notificationsList').innerHTML = html;
    }
  
    function toggleNotifications() {
      const dropdown = document.getElementById('notificationsDropdown');
      dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    }
  
    // Update Auth Listener
    firebase.auth().onAuthStateChanged(user => {
      if(user) {
        setupNotifications();
        // ... existing auth code ...
      }
    });
</script>
  <div id="logoutModal" class="modal">
    <div class="modal-content">
      <span class="close-modal">&times;</span>
      <p id="logoutMessage"></p>
    </div>
  </div>
</body>
</html>